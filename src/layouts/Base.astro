---
import "../styles/global.css";

export interface Props {
  title: string;
  description?: string;
  keywords?: string;
  ogImage?: string;
  article?: {
    publishedTime?: string;
    modifiedTime?: string;
    author?: string;
    section?: string;
    tags?: string[];
  };
  forceNavSolid?: boolean;
}

const {
  title,
  description = "Wir bauen KI Agenten, die Support, Backoffice und HR entlasten – damit Sie mehr Zeit für Kunden und Entscheidungen haben",
  keywords = "KI Automatisierung Selbstständige, kleine Teams automatisieren, Freelancer KI Tools, bis 50 Mitarbeiter Automatisierung, Prozesse automatisieren kleine Teams, Support entlasten Selbstständige, Backoffice automatisieren Freelancer, E-Mail Automatisierung, DSGVO konform, Solopreneur Automatisierung",
  ogImage,
  article,
  forceNavSolid = false,
} = Astro.props;
// Normalize canonical URL: remove trailing slashes, .html extension, and query params
let pathname = Astro.url.pathname;
// Remove .html extension if present
if (pathname.endsWith(".html")) {
  pathname = pathname.slice(0, -5);
}
// Remove trailing slashes (except root)
if (pathname !== "/" && pathname.endsWith("/")) {
  pathname = pathname.slice(0, -1);
}
const canonicalURL = new URL(pathname, Astro.site ?? "https://codariq.de");
const canonicalHref =
  canonicalURL.pathname === "/" ? canonicalURL.origin : canonicalURL.toString();
const resolvedOgImage = ogImage
  ? ogImage.startsWith("http")
    ? ogImage
    : `${canonicalURL.origin}${ogImage}`
  : `${canonicalURL.origin}/images/hero/hero2.webp`;
const isArticle = Boolean(article);
const ogType = isArticle ? "article" : "website";
const articleAuthor = article?.author || "Codariq Team";
const articleSchema = isArticle
  ? {
      "@context": "https://schema.org",
      "@type": "BlogPosting",
      headline: title,
      description,
      image: [resolvedOgImage],
      datePublished: article?.publishedTime,
      dateModified: article?.modifiedTime || article?.publishedTime,
      author: {
        "@type": "Person",
        name: articleAuthor,
      },
      mainEntityOfPage: {
        "@type": "WebPage",
        "@id": canonicalHref,
      },
      publisher: {
        "@type": "Organization",
        name: "Codariq",
        url: canonicalURL.origin,
      },
      articleSection: article?.section,
      keywords: article?.tags?.length ? article.tags.join(", ") : undefined,
    }
  : null;
const shouldNoIndex = Boolean(Astro.url.searchParams.get("search"));
---

<!doctype html>
<html lang="de" class="scroll-smooth bg-white">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <meta name="theme-color" content="#1d4ed8" />
    <meta name="msapplication-TileColor" content="#1d4ed8" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Codariq" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/android-chrome-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="512x512"
      href="/android-chrome-512x512.png"
    />
    <meta
      name="msapplication-TileImage"
      content="/android-chrome-192x192.png"
    />
    <link rel="manifest" href="/manifest.json" />
    <link rel="canonical" href={canonicalHref} />

    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />
    <meta name="author" content={article?.author ?? "Codariq"} />
    <meta
      name="keywords"
      content={keywords}
    />
    <meta name="robots" content={shouldNoIndex ? "noindex, follow" : "index, follow"} />
    <meta name="language" content="de" />
    <meta name="revisit-after" content="7 days" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content={ogType} />
    <meta property="og:url" content={canonicalHref} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta
      property="og:image"
      content={resolvedOgImage}
    />
    <meta property="og:image:width" content="1536" />
    <meta property="og:image:height" content="1024" />
    <meta property="og:image:type" content="image/webp" />
    <meta property="og:locale" content="de_DE" />
    <meta property="og:site_name" content="Codariq" />
    {isArticle && article?.publishedTime && (
      <meta property="article:published_time" content={article.publishedTime} />
    )}
    {isArticle && article?.modifiedTime && (
      <meta property="article:modified_time" content={article.modifiedTime} />
    )}
    {isArticle && article?.author && (
      <meta property="article:author" content={article.author} />
    )}
    {isArticle && article?.section && (
      <meta property="article:section" content={article.section} />
    )}
    {isArticle &&
      article?.tags?.map((tag) => (
        <meta property="article:tag" content={tag} />
      ))}

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalHref} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta
      name="twitter:image"
      content={resolvedOgImage}
    />
    <meta
      name="twitter:image:alt"
      content="Codariq KI-Automatisierung Dashboard für deutsche Unternehmen"
    />
    <meta name="twitter:site" content="@codariq" />
    <meta name="twitter:creator" content="@codariq" />

    <!-- Additional SEO -->
    <meta name="geo.region" content="DE-BE" />
    <meta name="geo.placename" content="Berlin" />
    <meta name="geo.position" content="52.520008;13.404954" />
    <meta name="ICBM" content="52.520008, 13.404954" />

    <!-- Sitemap -->
    <link rel="sitemap" type="application/xml" href="/sitemap-index.xml" />

    <!-- Fonts -->
    <link
      rel="preload"
      href="/fonts/Satoshi-Variable.woff2"
      as="font"
      type="font/woff2"
      crossorigin="anonymous"
    />

    <!-- Global Styles -->
    <style>
      @font-face {
        font-family: "Satoshi";
        src: url("/fonts/Satoshi-Variable.woff2") format("woff2");
        font-weight: 300 900;
        font-style: normal;
        font-display: swap;
      }

      html {
        font-family: "Satoshi", system-ui, sans-serif;
        background-color: white;
      }

      body {
        background-color: white;
      }

      /* Enhanced focus styles for EAA compliance */
      :focus-visible {
        outline: 3px solid var(--color-nav-focus);
        outline-offset: 2px;
        border-radius: 4px;
      }

      /* High contrast mode support */
      @media (prefers-contrast: high) {
        :focus-visible {
          outline: 4px solid;
          outline-color: Highlight;
        }
      }

      /* Consistent CTA button animations */
      .cta-button {
        transform-origin: center;
        transition:
          transform 0.2s ease,
          background-color 0.2s ease;
        will-change: transform;
        backface-visibility: hidden;
      }

      .cta-button:hover {
        transform: scale(1.02);
      }

      /* Navigation link hover effect with growing underline (desktop only) */
      .nav-link {
        position: relative;
        display: inline-block;
        transition: color 0.3s ease;
      }

      /* Underline hover effect only on desktop (md breakpoint and up) */
      @media (min-width: 768px) {
        .nav-link::after {
          content: '';
          position: absolute;
          width: 0;
          height: 2px;
          bottom: -4px;
          left: 50%;
          background-color: var(--color-nav-underline);
          transition: width 0.3s ease, left 0.3s ease;
        }

        .nav-link:hover::after {
          width: 100%;
          left: 0;
        }
      }

      /* Color transitions for navigation elements when scrolling */
      #main-nav .nav-link,
      #main-nav svg,
      #main-nav button,
      #nav-logo {
        transition: color 0.3s ease, stroke 0.3s ease, opacity 0.3s ease;
      }

      /* Default: no header background, dark elements */
      header {
        background: transparent !important;
        backdrop-filter: none;
        -webkit-backdrop-filter: none;
        border-color: transparent !important;
        transition:
          background-color 500ms cubic-bezier(0.16, 1, 0.3, 1),
          border-color 500ms cubic-bezier(0.16, 1, 0.3, 1),
          box-shadow 500ms cubic-bezier(0.16, 1, 0.3, 1),
          backdrop-filter 500ms cubic-bezier(0.16, 1, 0.3, 1),
          -webkit-backdrop-filter 500ms cubic-bezier(0.16, 1, 0.3, 1);
        will-change: background-color, border-color, box-shadow, backdrop-filter;
      }

      #main-nav .nav-link {
        color: var(--color-nav-link) !important;
      }

      #main-nav .nav-link:hover {
        color: var(--color-nav-link-hover) !important;
      }

      #main-nav svg,
      #main-nav button {
        color: var(--color-nav-link) !important;
        stroke: currentColor;
      }

      #main-nav button:hover {
        color: var(--color-nav-link-hover) !important;
      }

      #nav-logo {
        height: 28px;
        width: auto;
        opacity: 0.95;
        display: block;
      }

      /* Dark mode for navigation when scrolled past hero */
      header.nav-scrolled #main-nav .nav-link {
        color: var(--color-nav-link) !important;
      }

      header.nav-scrolled #main-nav svg {
        color: var(--color-nav-link) !important;
        stroke: currentColor;
      }

      header.nav-scrolled #main-nav button {
        color: var(--color-nav-link) !important;
      }

      /* Keep hover states working in both modes */
      header.nav-scrolled #main-nav .nav-link:hover {
        color: var(--color-neutral-gray-600) !important;
      }

      header.nav-scrolled #main-nav button:hover {
        color: var(--color-neutral-gray-600) !important;
      }

      /* Logo shows natural dark color when scrolled */
      header.nav-scrolled #nav-logo {
        opacity: 1;
      }

      .footer-logo {
        filter: brightness(0) invert(1);
      }

      /* After scrolling past hero: blurred white header background */
      header.nav-scrolled {
        background: var(--color-nav-bg-scrolled);
        border-color: var(--color-nav-border-scrolled) !important;
        box-shadow: 0 10px 30px var(--color-nav-shadow-scrolled);
        backdrop-filter: blur(16px);
        -webkit-backdrop-filter: blur(16px);
      }

      /* Mobile menu button color transition */
      #mobile-menu-button {
        transition: color 0.3s ease;
      }

      /* Dark color for mobile menu button when scrolled */
      header.nav-scrolled #mobile-menu-button {
        color: #374151 !important; /* text-gray-700 */
      }

      /* Reduced motion for accessibility */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }

        .cta-button:hover {
          transform: none !important;
        }
      }
    </style>

    <!-- Enhanced Structured Data -->
    <!-- WebSite Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Codariq - KI-Automatisierung für Selbstständige und kleine Teams",
        "alternateName": "Codariq",
        "url": "https://codariq.de",
        "description": "Professionelle KI-Automatisierungslösungen für Selbstständige und kleine Teams bis 50 Personen in Deutschland, Österreich und der Schweiz. Weniger Routinearbeit, mehr Zeit für Kunden.",
        "inLanguage": "de-DE",
        "publisher": {
          "@type": "Organization",
          "name": "Codariq"
        }
      }
    </script>

    <!-- Organization Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Codariq",
        "alternateName": "codariq",
        "description": "Spezialisiert auf KI-Automatisierung für Selbstständige und kleine Teams bis 50 Personen. Wir automatisieren E-Mails, Dokumente, Backoffice-Prozesse und entlasten Routinearbeit. DSGVO-konform und verständlich erklärt.",
        "url": "https://codariq.de",
        "image": "https://codariq.de/images/hero/hero2.webp",
        "foundingDate": "2025",
        "foundingLocation": {
          "@type": "Place",
          "address": {
            "@type": "PostalAddress",
            "addressLocality": "Berlin",
            "addressCountry": "DE"
          }
        },
        "contactPoint": [
          {
            "@type": "ContactPoint",
            "contactType": "Customer Service",
            "areaServed": ["DE", "AT", "CH"],
            "availableLanguage": ["German", "English"],
            "hoursAvailable": {
              "@type": "OpeningHoursSpecification",
              "dayOfWeek": [
                "Monday",
                "Tuesday",
                "Wednesday",
                "Thursday",
                "Friday"
              ],
              "opens": "09:00",
              "closes": "18:00"
            }
          },
          {
            "@type": "ContactPoint",
            "email": "kontakt@codariq.de",
            "contactType": "Sales",
            "areaServed": ["DE", "AT", "CH"],
            "availableLanguage": ["German", "English"]
          }
        ],
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Berlin",
          "addressRegion": "Berlin",
          "addressCountry": "DE"
        },
        "sameAs": [
          "https://www.linkedin.com/company/codariq",
          "https://www.xing.com/companies/codariq"
        ],
        "knowsAbout": [
          "KI-Automatisierung für Selbstständige",
          "E-Mail Automatisierung für kleine Teams",
          "Dokumenten-Verarbeitung",
          "Backoffice Automatisierung",
          "Prozessautomatisierung für Freelancer",
          "Workflow-Automatisierung bis 50 Mitarbeiter",
          "DSGVO-konforme Automatisierung",
          "Künstliche Intelligenz für kleine Unternehmen"
        ],
        "serviceArea": {
          "@type": "Country",
          "name": "Deutschland"
        },
        "hasOfferCatalog": {
          "@type": "OfferCatalog",
          "name": "KI-Automatisierungslösungen",
          "itemListElement": [
            {
              "@type": "Offer",
              "@id": "https://codariq.de/#starter-paket",
              "itemOffered": {
                "@type": "Service",
                "name": "Starter Paket",
                "description": "Für Selbstständige und kleine Teams, die einen Ablauf spürbar entlasten wollen. Auch wenn du allein bist: Automationen übernehmen Aufgaben wie ein zusätzliches Teammitglied.",
                "provider": {
                  "@type": "Organization",
                  "name": "Codariq"
                },
                "areaServed": ["DE", "AT", "CH"],
                "serviceType": "Business Process Automation",
                "category": "Artificial Intelligence Implementation"
              },
              "price": "399",
              "priceCurrency": "EUR",
              "priceSpecification": {
                "@type": "PriceSpecification",
                "price": "399",
                "priceCurrency": "EUR",
                "valueAddedTaxIncluded": true
              },
              "availability": "https://schema.org/InStock"
            },
            {
              "@type": "Offer",
              "@id": "https://codariq.de/#team-paket",
              "itemOffered": {
                "@type": "Service",
                "name": "Team Paket",
                "description": "Für Selbstständige und kleine Teams, die mehrere Abläufe verbinden wollen, ohne dass es kompliziert wird. Deine Automationen und Agenten arbeiten wie ein eingespieltes Team im Hintergrund.",
                "provider": {
                  "@type": "Organization",
                  "name": "Codariq"
                },
                "areaServed": ["DE", "AT", "CH"],
                "serviceType": "Custom AI Development",
                "category": "Artificial Intelligence Implementation"
              },
              "price": "1499",
              "priceCurrency": "EUR",
              "priceSpecification": {
                "@type": "PriceSpecification",
                "price": "1499",
                "priceCurrency": "EUR",
                "valueAddedTaxIncluded": true
              },
              "availability": "https://schema.org/InStock"
            },
            {
              "@type": "Offer",
              "@id": "https://codariq.de/#wachstums-paket",
              "itemOffered": {
                "@type": "Service",
                "name": "Wachstums Paket",
                "description": "Für Selbstständige und Teams bis 50 Personen, die einen Bereich stabil und dauerhaft automatisieren wollen. So schaffst du mehr Volumen, ohne ständig neue Leute zu brauchen.",
                "provider": {
                  "@type": "Organization",
                  "name": "Codariq"
                },
                "areaServed": ["DE", "AT", "CH"],
                "serviceType": "Enterprise AI Automation",
                "category": "Artificial Intelligence Implementation"
              },
              "price": "3499",
              "priceCurrency": "EUR",
              "priceSpecification": {
                "@type": "PriceSpecification",
                "price": "3499",
                "priceCurrency": "EUR",
                "valueAddedTaxIncluded": true
              },
              "availability": "https://schema.org/InStock"
            }
          ]
        }
      }
    </script>

    <!-- Special Announcement Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "SpecialAnnouncement",
        "name": "Kostenlose KI-Automatisierung Strategieberatung",
        "text": "Erhalten Sie eine kostenlose 45-minütige Strategieberatung zur Identifikation Ihrer besten KI-Automatisierungsmöglichkeiten. Unverbindlich und ohne Risiko.",
        "category": "https://www.wikidata.org/wiki/Q186386",
        "datePosted": "2026-01-29",
        "expires": "2026-12-31",
        "spatialCoverage": {
          "@type": "Country",
          "name": "Deutschland"
        },
        "announcementLocation": {
          "@type": "VirtualLocation",
          "url": "https://codariq.de"
        },
        "publisher": {
          "@type": "Organization",
          "name": "Codariq",
          "url": "https://codariq.de"
        }
      }
    </script>

    <!-- Local Business Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "ProfessionalService",
        "name": "Codariq - KI-Automatisierung",
        "image": "https://codariq.de/images/hero/hero2.webp",
        "@id": "https://codariq.de",
        "url": "https://codariq.de",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Berlin",
          "addressRegion": "Berlin",
          "postalCode": "10713",
          "addressCountry": "DE"
        },
        "openingHoursSpecification": {
          "@type": "OpeningHoursSpecification",
          "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
          "opens": "09:00",
          "closes": "18:00"
        },
        "priceRange": "€€€",
        "serviceType": "Business Automation and AI Services"
      }
    </script>

    {articleSchema && (
      <script
        type="application/ld+json"
        set:html={JSON.stringify(articleSchema)}
      />
    )}

    <!-- Cookiebot Consent Management -->
    <script
      id="Cookiebot"
      src="https://consent.cookiebot.com/uc.js"
      data-cbid="5b61b27b-4228-425d-8a66-0601f96037a1"
      data-blockingmode="auto"
      type="text/javascript"
    ></script>

    <!-- Google tag (gtag.js) -->
    <script is:inline async src="https://www.googletagmanager.com/gtag/js?id=G-6TLXVYD8V2" crossorigin="anonymous"></script>
    <script is:inline crossorigin="anonymous">
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6TLXVYD8V2');
    </script>

    <!-- Calendly Link-Widget -->
    <link
      href="https://assets.calendly.com/assets/external/widget.css"
      rel="stylesheet"
    />
    <script
      is:inline
      src="https://assets.calendly.com/assets/external/widget.js"
      type="text/javascript"
      defer
    ></script>
  </head>

  <body
    class="bg-white text-gray-900 antialiased overscroll-behavior-y-contain"
    data-force-nav-solid={forceNavSolid}
  >
    <!-- Skip Links for accessibility -->
    <a
      href="#main-content"
      class="sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 bg-blue-600 text-white p-3 z-50 focus:z-50 rounded"
    >
      Zum Hauptinhalt springen
    </a>

    <div class="min-h-screen flex flex-col">
      <header
        class={`fixed top-0 left-0 right-0 z-50 transition-all duration-500 ease-out ${forceNavSolid ? "nav-scrolled" : ""}`}
        style="position: fixed !important; transform: translateY(0) !important;"
      >
        <!-- Header content will be added here -->
        <nav
          class="max-w-8xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 xl:px-16 h-14 sm:h-16 flex items-center justify-between sm:grid sm:grid-cols-3 relative"
          id="main-nav"
        >
          <!-- Left: Logo -->
          <div class="flex items-center justify-start">
            <a href="/" class="hover:opacity-90 transition-all duration-300">
              <img
                id="nav-logo"
                src="/images/logos/codariqLogo1.svg"
                alt="Codariq"
                class="h-7 sm:h-8 w-auto"
                loading="lazy"
                decoding="async"
              />
            </a>
          </div>

          <!-- Center: Desktop Navigation -->
          <div
            class="hidden sm:flex items-center justify-center space-x-4 md:space-x-8"
            id="nav-links"
          >
            <a
              href="/#process"
              class="nav-link transition-colors font-medium text-sm md:text-base"
              >Prozess</a
            >
            <a
              href="/#benefits"
              class="nav-link transition-colors font-medium text-sm md:text-base"
              >Preise</a
            >
            <a
              href="/#testimonials"
              class="nav-link transition-colors font-medium text-sm md:text-base"
              >Referenzen</a
            >
            <a
              href="/faq"
              class="nav-link transition-colors font-medium text-sm md:text-base"
              >FAQ</a
            >
            <a
              href="/#insights"
              class="nav-link transition-colors font-medium text-sm md:text-base"
              >Blog</a
            >
          </div>

          <!-- Mobile: Centered Burger Menu -->
          <div class="absolute left-1/2 -translate-x-1/2 sm:hidden">
            <button
              id="mobile-menu-button"
              class="p-2 text-gray-700 hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-orange-500 rounded-lg"
              aria-label="Menu öffnen"
              aria-expanded="false"
            >
              <svg
                class="menu-icon w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"></path>
              </svg>
              <svg
                class="close-icon hidden w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18L18 6M6 6l12 12"></path>
              </svg>
            </button>
          </div>

          <!-- Right: Social Icons + CTA Button -->
          <div class="flex items-center justify-end gap-4">
            <!-- Social Icons (Desktop only) -->
            <div class="hidden md:flex items-center gap-3">
              <!-- LinkedIn Icon -->
              <a
                href="https://www.linkedin.com/in/tarik-arthur-marshall-6112b2239"
                target="_blank"
                rel="noopener noreferrer"
                aria-label="LinkedIn Profil besuchen"
                class="text-gray-700 hover:text-orange-500 transition-colors duration-200"
              >
                <img
                  src="/images/logos/LinkedIn_icon.svg"
                  alt=""
                  aria-hidden="true"
                  class="w-5 h-5"
                />
              </a>

              <!-- Instagram Icon -->
              <a
                href="https://www.instagram.com/codariq"
                target="_blank"
                rel="noopener noreferrer"
                aria-label="Instagram Profil besuchen"
                class="text-gray-700 hover:text-orange-500 transition-colors duration-200"
              >
                <img
                  src="/images/logos/Instagram_logo_2016.svg"
                  alt=""
                  aria-hidden="true"
                  class="w-5 h-5"
                />
              </a>
            </div>

            <!-- CTA Button -->
            <a
              href="/#final-cta"
              class="bg-gradient-to-br from-[color:var(--color-cta-primary-from)] to-[color:var(--color-cta-primary-to)] text-white px-3 sm:px-4 md:px-6 py-2 rounded-full hover:from-[color:var(--color-cta-primary-hover)] hover:to-[color:var(--color-cta-primary-to)] transition-all duration-200 font-bold text-xs sm:text-sm md:text-base shadow-lg cta-button"
              aria-label="Strategiegespräch vereinbaren"
            >
              <span class="hidden sm:inline">Termin buchen</span>
              <span class="sm:hidden">Kontakt</span>
            </a>
          </div>
        </nav>

        <!-- Mobile Menu -->
        <div
          id="mobile-menu"
          class="sm:hidden hidden bg-white/95 backdrop-blur-lg border-b border-white/30"
        >
          <div class="px-4 py-3 space-y-3">
            <a
              href="/#process"
              class="block text-gray-800 hover:text-gray-600 transition-colors font-medium py-2"
              >Prozess</a
            >
            <a
              href="/#benefits"
              class="block text-gray-800 hover:text-gray-600 transition-colors font-medium py-2"
              >Preise</a
            >
            <a
              href="/#testimonials"
              class="block text-gray-800 hover:text-gray-600 transition-colors font-medium py-2"
              >Referenzen</a
            >
            <a
              href="/faq"
              class="block text-gray-800 hover:text-gray-600 transition-colors font-medium py-2"
              >FAQ</a
            >
            <a
              href="/#insights"
              class="block text-gray-800 hover:text-gray-600 transition-colors font-medium py-2"
              >Blog</a
            >
          </div>
        </div>
      </header>

      <main class="flex-1" id="main-content" role="main">
        <slot />
      </main>

      <footer class="bg-gray-800 border-t border-gray-700" role="contentinfo">
        <div
          class="max-w-8xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 xl:px-16 py-8 sm:py-10 md:py-12"
        >
          <div
            class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8 md:gap-6 lg:gap-8"
          >
            <!-- Column 1: Logo + Beschreibung -->
            <div class="text-left">
              <div class="mb-6">
                <img
                  src="/images/logos/codariqLogo1.svg"
                  alt="Codariq"
                  class="h-8 md:h-10 w-auto mb-4 footer-logo"
                  loading="lazy"
                  decoding="async"
                />
                <p
                  class="text-gray-300 text-sm leading-relaxed max-w-sm md:mx-0"
                >
                  Intelligente Automatisierungen für Selbstständige und kleine Teams.
                </p>

                <!-- Social Media Links -->
                <div class="flex items-center gap-4 mt-4">
                  <!-- LinkedIn -->
                  <a
                    href="https://www.linkedin.com/in/tarik-arthur-marshall-6112b2239"
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label="LinkedIn Profil besuchen"
                    class="text-gray-400 hover:text-orange-400 transition-colors duration-200"
                  >
                    <img
                      src="/images/logos/LinkedIn_icon.svg"
                      alt=""
                      aria-hidden="true"
                      class="w-6 h-6"
                    />
                  </a>

                  <!-- Instagram -->
                  <a
                    href="https://www.instagram.com/codariq"
                    target="_blank"
                    rel="noopener noreferrer"
                    aria-label="Instagram Profil besuchen"
                    class="text-gray-400 hover:text-orange-400 transition-colors duration-200"
                  >
                    <img
                      src="/images/logos/Instagram_logo_2016.svg"
                      alt=""
                      aria-hidden="true"
                      class="w-6 h-6"
                    />
                  </a>
                </div>
              </div>
            </div>

            <!-- Column 2: Trust Badges + Industry Leaders -->
            <div class="text-left">
              <div class="mb-6">
                <h4 class="font-semibold text-gray-100 mb-3 text-sm">
                  Unsere Werte
                </h4>
                <div
                  class="flex flex-wrap justify-start gap-2 md:gap-3 mb-4"
                >
                  <img
                    src="/images/badges/climate-friendly.webp"
                    alt="Klimafreundlich"
                    class="h-15 md:h-17 w-auto"
                    loading="lazy"
                    decoding="async"
                  />
                  <img
                    src="/images/badges/gdpr-ready.webp"
                    alt="DSGVO konform"
                    class="h-10 md:h-17 w-auto"
                    loading="lazy"
                    decoding="async"
                  />
                  <img
                    src="/images/badges/remote-only.webp"
                    alt="Remote verfügbar"
                    class="h-10 md:h-17 w-auto"
                    loading="lazy"
                    decoding="async"
                  />
                </div>
              </div>

              <div>
                <span class="text-gray-400 text-xs mb-2 block"
                  >In zusammenarbeit mit:</span
                >
                <div
                  class="flex items-center justify-start space-x-2 md:space-x-3"
                >
                  <a
                    href="https://www.coursera.org/account/accomplishments/specialization/certificate/02X85MNGYZGE"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="hover:scale-105 transition-all duration-200"
                    aria-label="View Google certification on Coursera"
                  >
                    <img
                      src="/images/logos/google.svg"
                      alt="Google"
                      class="h-6 md:h-8 w-auto brightness-0 invert opacity-80 hover:opacity-100 transition-opacity"
                      loading="lazy"
                      decoding="async"
                    />
                  </a>
                  <a
                    href="https://www.credly.com/badges/bc236bf7-2cb8-4435-bbea-660a4c37329e/public_url"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="hover:scale-105 transition-all duration-200"
                    aria-label="View IBM certification on Credly"
                  >
                    <img
                      src="/images/logos/ibm.svg"
                      alt="IBM"
                      class="h-8 md:h-10 w-auto brightness-0 invert opacity-80 hover:opacity-100 transition-opacity"
                      loading="lazy"
                      decoding="async"
                    />
                  </a>
                  <a
                    href="https://learn.deeplearning.ai/accomplishments/4c4f4d61-8e90-4756-b0a3-1b32b7111c97?usp=sharing"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="hover:scale-105 transition-all duration-200"
                    aria-label="View DeepLearning.AI accomplishments"
                  >
                    <img
                      src="/images/logos/openai.svg"
                      alt="OpenAI"
                      class="h-6 md:h-8 w-auto brightness-0 invert opacity-80 hover:opacity-100 transition-opacity"
                      loading="lazy"
                      decoding="async"
                    />
                  </a>
                </div>
              </div>
            </div>

            <!-- Column 3: Unternehmen -->
            <div class="text-left">
              <h3 class="font-semibold text-gray-100 mb-4">Unternehmen</h3>
              <ul class="space-y-2 text-gray-300 mb-6">
                <li>
                  <a
                    href="/impressum"
                    class="hover:text-orange-400 transition-colors">Impressum</a
                  >
                </li>
                <li>
                  <a
                    href="/datenschutz"
                    class="hover:text-orange-400 transition-colors"
                    >Datenschutzerklärung</a
                  >
                </li>
                <li>
                  <a
                    href="/cookie-richtlinien"
                    class="hover:text-orange-400 transition-colors"
                    >Cookie-Richtlinien</a
                  >
                </li>
                <li>
                  <a href="/faq" class="hover:text-orange-400 transition-colors"
                    >FAQ</a
                  >
                </li>
                <li>
                  <a href="/agb" class="hover:text-orange-400 transition-colors"
                    >AGB</a
                  >
                </li>
              </ul>
            </div>

            <!-- Column 4: Für wen -->
            <div class="text-left">
              <h4 class="font-semibold text-gray-100 mb-3 text-sm">
                Für wen
              </h4>
              <ul class="space-y-2 text-sm text-gray-300">
                <li>
                  <a
                    href="/automatisierung-selbststaendige"
                    class="hover:text-orange-400 transition-colors duration-200"
                    >für Selbstständige</a
                  >
                </li>
                <li>
                  <a
                    href="/automatisierung-gruender"
                    class="hover:text-orange-400 transition-colors duration-200"
                    >für Gründer</a
                  >
                </li>
                <li>
                  <a
                    href="/automatisierung-kleine-teams"
                    class="hover:text-orange-400 transition-colors duration-200"
                    >für kleine Teams</a
                  >
                </li>
              </ul>
            </div>

            <!-- Column 5: Kontakt + Newsletter -->
            <div class="text-left">
              <!-- Kontakt Section -->
              <div class="mb-6">
                <h3 class="font-semibold text-gray-100 mb-3">Kontakt</h3>
                <ul class="space-y-2 text-gray-300 text-sm">
                  <li>kontakt@codariq.de</li>
                  <li>Made in Berlin ❤️</li>
                </ul>
              </div>

              <!-- Newsletter Section -->
              <div>
                <h4 class="font-semibold text-gray-100 mb-2">Newsletter</h4>
                <p class="text-gray-400 text-xs mb-3">KI-News & Insights</p>

                <!-- Newsletter Success Message -->
                <div
                  id="newsletter-success"
                  role="alert"
                  aria-live="polite"
                  class="hidden mb-3 p-2 bg-green-900/20 border border-green-600 rounded-lg"
                >
                  <div class="flex items-center">
                    <svg
                      class="w-3 h-3 text-green-400 mr-2"
                      fill="currentColor"
                      viewBox="0 0 20 20"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                        clip-rule="evenodd"></path>
                    </svg>
                    <div>
                      <p class="font-medium text-green-300 text-xs">
                        Erfolgreich angemeldet!
                      </p>
                      <p class="text-green-400 text-xs">
                        Bestätigungs-E-Mail folgt!
                      </p>
                    </div>
                  </div>
                </div>

                <!-- Newsletter Error Messages -->
                <div
                  id="newsletter-errors"
                  role="alert"
                  aria-live="polite"
                  class="hidden mb-3 p-2 bg-red-900/20 border border-red-600 rounded-lg"
                >
                  <p class="font-medium text-red-300 text-xs mb-1">
                    Bitte korrigieren:
                  </p>
                  <ul
                    id="newsletter-error-list"
                    class="list-disc list-inside text-red-400 text-xs"
                  >
                  </ul>
                </div>

                <!-- Newsletter Form (Compact Horizontal Layout) -->
                <form id="newsletter-form" class="flex gap-2">
                  <div class="flex-1">
                    <label for="footer-newsletter-email" class="sr-only"
                      >E-Mail-Adresse</label
                    >
                    <input
                      type="email"
                      id="footer-newsletter-email"
                      name="email"
                      required
                      autocomplete="email"
                      placeholder="ihre@email.de"
                      aria-describedby="footer-newsletter-email-error"
                      class="w-full px-3 py-2 border border-gray-600 bg-gray-700 text-white rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent transition-all text-sm placeholder-gray-400"
                    />
                    <div
                      id="footer-newsletter-email-error"
                      role="alert"
                      aria-live="polite"
                      class="text-sm text-red-400 mt-1 hidden"
                    >
                    </div>
                  </div>

                  <button
                    type="submit"
                    class="bg-gradient-to-br from-[color:var(--color-cta-primary-from)] to-[color:var(--color-cta-primary-to)] text-white px-4 py-2 rounded-lg hover:from-[color:var(--color-cta-primary-hover)] hover:to-[color:var(--color-cta-primary-to)] font-medium text-sm transition-all duration-200 shadow-md cta-button whitespace-nowrap"
                  >
                    Abonnieren
                  </button>
                </form>

                <p class="text-xs text-gray-400 mt-2">
                  Kostenlos und jederzeit kündbar.
                  <a href="/datenschutz" class="underline hover:text-orange-400"
                    >Datenschutz</a
                  >
                </p>
              </div>
            </div>
          </div>
          <div
            class="border-t border-gray-600 mt-6 pt-6 text-center text-gray-400"
          >
            <p>&copy; 2025 Codariq. Alle Rechte vorbehalten.</p>
          </div>
        </div>
      </footer>

      <!-- Mobile Menu and Smooth Scrolling JavaScript -->
      <script>
        document.addEventListener("DOMContentLoaded", async function () {
          // Newsletter form elements (footer)
          const footerNewsletterForm =
            document.getElementById("newsletter-form");
          const footerNewsletterErrors =
            document.getElementById("newsletter-errors");
          const footerNewsletterErrorList = document.getElementById(
            "newsletter-error-list",
          );
          const footerNewsletterSuccess =
            document.getElementById("newsletter-success");

          // Check for newsletter success parameter in URL
          const urlParams = new URLSearchParams(window.location.search);
          if (urlParams.get("newsletter") === "success") {
            if (footerNewsletterSuccess && footerNewsletterForm) {
              footerNewsletterSuccess.classList.remove("hidden");
              footerNewsletterForm.style.display = "none";

              // Clean URL to remove newsletter parameter
              window.history.replaceState(
                {},
                document.title,
                window.location.pathname,
              );
            }
          }

          // Footer Newsletter form submission with webhook
          if (
            footerNewsletterForm &&
            footerNewsletterErrors &&
            footerNewsletterErrorList
          ) {
            // Import form helpers dynamically
            const { showFieldError, hideFieldError, setButtonLoading, submitFormData } =
              await import("../utils/formHelpers.ts");

            footerNewsletterForm.addEventListener("submit", async function (e) {
              e.preventDefault();

              // Reset error states
              if (footerNewsletterErrors)
                footerNewsletterErrors.classList.add("hidden");
              if (footerNewsletterErrorList) {
                // Clear error list safely
                while (footerNewsletterErrorList.firstChild) {
                  footerNewsletterErrorList.removeChild(footerNewsletterErrorList.firstChild);
                }
              }

              // Get email field
              const email = document.getElementById(
                "footer-newsletter-email",
              ) as HTMLInputElement;
              const submitButton = footerNewsletterForm.querySelector(
                'button[type="submit"]',
              ) as HTMLButtonElement;

              let hasErrors = false;
              const errors: string[] = [];

              // Validate email
              const isValidEmail = (email: string) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
              if (
                !email?.value?.trim() ||
                !isValidEmail(email.value.trim())
              ) {
                errors.push("Bitte geben Sie eine gültige E-Mail-Adresse ein");
                showFieldError("footer-newsletter-email", "Bitte geben Sie eine gültige E-Mail-Adresse ein");
                hasErrors = true;
              } else {
                hideFieldError("footer-newsletter-email");
              }

              // If there are errors, show error messages
              if (hasErrors) {
                if (footerNewsletterErrors)
                  footerNewsletterErrors.classList.remove("hidden");
                errors.forEach((error) => {
                  const li = document.createElement("li");
                  li.textContent = error;
                  if (footerNewsletterErrorList)
                    footerNewsletterErrorList.appendChild(li);
                });
                return;
              }

              // Set loading state
              if (submitButton) {
                setButtonLoading(submitButton, true, "Wird gesendet...");
              }

              try {
                // Send to server-side API endpoint
                await submitFormData("/api/newsletter", {
                  email: email.value.trim(),
                  source: "footer_newsletter",
                  timestamp: new Date().toISOString(),
                  userAgent: navigator.userAgent,
                });

                // Show success message
                if (footerNewsletterSuccess) {
                  footerNewsletterSuccess.classList.remove("hidden");
                  footerNewsletterForm.style.display = "none";
                }
              } catch (error) {
                console.error("Newsletter subscription error:", error);
                if (footerNewsletterErrors) {
                  footerNewsletterErrors.classList.remove("hidden");
                  const li = document.createElement("li");
                  li.textContent =
                    "Ein Fehler ist aufgetreten. Bitte versuchen Sie es später erneut.";
                  if (footerNewsletterErrorList)
                    footerNewsletterErrorList.appendChild(li);
                }
              } finally {
                // Reset loading state
                if (submitButton) {
                  setButtonLoading(submitButton, false, "Abonnieren");
                }
              }
            });
          }

          // Mobile Menu Logic
          const mobileMenuButton =
            document.getElementById("mobile-menu-button");
          const mobileMenu = document.getElementById("mobile-menu");

          if (mobileMenuButton && mobileMenu) {
            const menuIcon = mobileMenuButton.querySelector('.menu-icon');
            const closeIcon = mobileMenuButton.querySelector('.close-icon');

            mobileMenuButton.addEventListener("click", function () {
              const isExpanded =
                mobileMenuButton.getAttribute("aria-expanded") === "true";

              if (isExpanded) {
                mobileMenu.classList.add("hidden");
                mobileMenuButton.setAttribute("aria-expanded", "false");
                menuIcon?.classList.remove('hidden');
                closeIcon?.classList.add('hidden');
              } else {
                mobileMenu.classList.remove("hidden");
                mobileMenuButton.setAttribute("aria-expanded", "true");
                menuIcon?.classList.add('hidden');
                closeIcon?.classList.remove('hidden');
              }
            });

            // Close mobile menu when clicking on a link
            const mobileLinks = mobileMenu.querySelectorAll("a");
            mobileLinks.forEach((link) => {
              link.addEventListener("click", function () {
                mobileMenu.classList.add("hidden");
                mobileMenuButton.setAttribute("aria-expanded", "false");
                menuIcon?.classList.remove('hidden');
                closeIcon?.classList.add('hidden');
              });
            });
          }

          // Enhanced Smooth Scrolling for Internal Links
          const allLinks = document.querySelectorAll(
            'a[href^="#"], a[href^="/#"]',
          );
          allLinks.forEach((link) => {
            link.addEventListener(
              "click",
              function (this: HTMLAnchorElement, e) {
                const href = this.getAttribute("href");
                if (!href) return;

                const targetId = href.startsWith("/#")
                  ? href.substring(2)
                  : href.substring(1);
                const targetElement = document.getElementById(targetId);

                if (targetElement) {
                  e.preventDefault();

                  // Close mobile menu if open
                  if (mobileMenu && !mobileMenu.classList.contains("hidden")) {
                    mobileMenu.classList.add("hidden");
                    if (mobileMenuButton) {
                      mobileMenuButton.setAttribute("aria-expanded", "false");
                      const menuIcon = mobileMenuButton.querySelector('.menu-icon');
                      const closeIcon = mobileMenuButton.querySelector('.close-icon');
                      menuIcon?.classList.remove('hidden');
                      closeIcon?.classList.add('hidden');
                    }
                  }

                  // Smooth scroll with offset for fixed header
                  const headerHeight =
                    document.getElementById("main-nav")?.getBoundingClientRect()
                      .height || 64;
                  const headerOffset = headerHeight + 20; // Account for fixed header + some padding
                  const elementPosition =
                    targetElement.getBoundingClientRect().top;
                  const offsetPosition =
                    elementPosition + window.pageYOffset - headerOffset;

                  window.scrollTo({
                    top: offsetPosition,
                    behavior: "smooth",
                  });

                  // Update URL without causing a jump
                  window.history.pushState({}, "", href);
                }
              },
            );
          });

          // Initialize scroll effects (extracted to separate module)
          const { initAllScrollEffects } = await import("../scripts/scrollEffects.ts");
          initAllScrollEffects();
        });
      </script>
    </div>
  </body>
</html>
