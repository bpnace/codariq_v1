---
import CookieConsent from '../components/CookieConsent.astro';
import '../styles/global.css';

export interface Props {
  title: string;
  description?: string;
  ogImage?: string;
}

const {
  title,
  description = 'KI-Automatisierungsexperte für kleine und mittelständische Unternehmen',
  ogImage,
} = Astro.props;
const canonicalURL = new URL(Astro.url.pathname, 'https://codariq.de');
---

<!doctype html>
<html lang="de" class="scroll-smooth bg-white">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#1E3A8A" />
    <meta name="msapplication-TileColor" content="#1E3A8A" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />
    <meta name="apple-mobile-web-app-title" content="Codariq" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/android-chrome-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="512x512"
      href="/android-chrome-512x512.png"
    />
    <meta
      name="msapplication-TileImage"
      content="/android-chrome-192x192.png"
    />
    <link rel="manifest" href="/manifest.json" />
    <link rel="canonical" href={canonicalURL} />

    <!-- Primary Meta Tags -->
    <title>{title}</title>
    <meta name="title" content={title} />
    <meta name="description" content={description} />
    <meta name="author" content="Codariq - KI-Automatisierungsexperte" />
    <meta name="keywords" content="KI-Automatisierung, Künstliche Intelligenz, Prozessautomatisierung, Mittelstand, Deutschland, Business Intelligence, Machine Learning, DSGVO, Digitalisierung" />
    <meta name="robots" content="index, follow" />
    <meta name="language" content="de" />
    <meta name="revisit-after" content="7 days" />

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:image" content={ogImage || `${canonicalURL.origin}/images/hero/hero2.webp`} />
    <meta property="og:image:width" content="1536" />
    <meta property="og:image:height" content="1024" />
    <meta property="og:image:type" content="image/webp" />
    <meta property="og:locale" content="de_DE" />
    <meta property="og:site_name" content="Codariq" />

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:url" content={canonicalURL} />
    <meta name="twitter:title" content={title} />
    <meta name="twitter:description" content={description} />
    <meta name="twitter:image" content={ogImage || `${canonicalURL.origin}/images/hero/hero2.webp`} />
    <meta name="twitter:image:alt" content="Codariq KI-Automatisierung Dashboard für deutsche Unternehmen" />
    <meta name="twitter:site" content="@codariq" />
    <meta name="twitter:creator" content="@codariq" />

    <!-- Additional SEO -->
    <meta name="geo.region" content="DE-BE" />
    <meta name="geo.placename" content="Berlin" />
    <meta name="geo.position" content="52.520008;13.404954" />
    <meta name="ICBM" content="52.520008, 13.404954" />
    
    <!-- Sitemap -->
    <link rel="sitemap" type="application/xml" href="/sitemap-index.xml" />
    
    <!-- Performance optimizations -->
    <link rel="dns-prefetch" href="https://assets.calendly.com" />
    <link rel="preconnect" href="https://assets.calendly.com" crossorigin />

    <!-- Fonts -->
    <link
      rel="preload"
      href="/fonts/Switzer-Variable.woff2"
      as="font"
      type="font/woff2"
      crossorigin
    />

    <!-- Global Styles -->
    <style>
      @font-face {
        font-family: 'Switzer Variable';
        src: url('/fonts/Switzer-Variable.woff2') format('woff2');
        font-weight: 100 900;
        font-style: normal;
        font-display: swap;
        size-adjust: 100.5%;
      }

      html {
        font-family: 'Switzer Variable', system-ui, sans-serif;
        background-color: white;
      }

      body {
        background-color: white;
      }

      /* Enhanced focus styles for EAA compliance */
      :focus-visible {
        outline: 3px solid #1e3a8a;
        outline-offset: 2px;
        border-radius: 4px;
      }

      /* High contrast mode support */
      @media (prefers-contrast: high) {
        :focus-visible {
          outline: 4px solid;
          outline-color: Highlight;
        }
      }

      /* Consistent CTA button animations */
      .cta-button {
        transform-origin: center;
        transition:
          transform 0.2s ease,
          background-color 0.2s ease;
        will-change: transform;
        backface-visibility: hidden;
      }

      .cta-button:hover {
        transform: scale(1.02);
      }

      /* Reduced motion for accessibility */
      @media (prefers-reduced-motion: reduce) {
        *,
        *::before,
        *::after {
          animation-duration: 0.01ms !important;
          animation-iteration-count: 1 !important;
          transition-duration: 0.01ms !important;
        }

        .cta-button:hover {
          transform: none !important;
        }
      }
    </style>

    <!-- Enhanced Structured Data -->
    <!-- WebSite Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "Codariq - KI-Automatisierung für KMU",
        "alternateName": "Codariq",
        "url": "https://codariq.de",
        "description": "Professionelle KI-Automatisierungslösungen für kleine und mittelständische Unternehmen in Deutschland, Österreich und der Schweiz",
        "inLanguage": "de-DE",
        "publisher": {
          "@type": "Organization",
          "name": "Codariq"
        },
        "potentialAction": {
          "@type": "SearchAction",
          "target": "https://codariq.de/?search={search_term_string}",
          "query-input": "required name=search_term_string"
        }
      }
    </script>

    <!-- Organization Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Codariq",
        "alternateName": "codariq",
        "description": "KI-Automatisierungsexperte für kleine und mittelständische Unternehmen. Spezialisiert auf Prozessautomatisierung, intelligente Datenanalyse und KI-gestützte Geschäftslösungen.",
        "url": "https://codariq.de",
        "logo": "https://codariq.de/Logo1.svg",
        "image": "https://codariq.de/images/hero/hero2.webp",
        "foundingDate": "2025",
        "foundingLocation": {
          "@type": "Place",
          "address": {
            "@type": "PostalAddress",
            "addressLocality": "Berlin",
            "addressCountry": "DE"
          }
        },
        "contactPoint": [
          {
            "@type": "ContactPoint",
            "telephone": "+49-176-31378294",
            "contactType": "Customer Service",
            "areaServed": ["DE", "AT", "CH"],
            "availableLanguage": ["German", "English"],
            "hoursAvailable": {
              "@type": "OpeningHoursSpecification",
              "dayOfWeek": [
                "Monday",
                "Tuesday",
                "Wednesday",
                "Thursday",
                "Friday"
              ],
              "opens": "09:00",
              "closes": "18:00"
            }
          },
          {
            "@type": "ContactPoint",
            "email": "kontakt@codariq.de",
            "contactType": "Sales",
            "areaServed": ["DE", "AT", "CH"],
            "availableLanguage": ["German", "English"]
          }
        ],
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Berlin",
          "addressRegion": "Berlin",
          "addressCountry": "DE"
        },
        "sameAs": [
          "https://www.linkedin.com/company/codariq",
          "https://www.xing.com/companies/codariq"
        ],
        "knowsAbout": [
          "Künstliche Intelligenz",
          "Prozessautomatisierung",
          "Machine Learning",
          "Robotic Process Automation",
          "Business Intelligence",
          "Digitale Transformation",
          "DSGVO Compliance",
          "Kleine und mittelständische Unternehmen"
        ],
        "serviceArea": {
          "@type": "Country",
          "name": "Deutschland"
        },
        "hasOfferCatalog": {
          "@type": "OfferCatalog",
          "name": "KI-Automatisierungslösungen",
          "itemListElement": [
            {
              "@type": "Offer",
              "@id": "https://codariq.de/#ai-readiness-check",
              "itemOffered": {
                "@type": "Service",
                "name": "AI Readiness Check",
                "description": "Umfassende Analyse zur Identifikation der besten KI-Automatisierungsmöglichkeiten",
                "provider": {
                  "@type": "Organization",
                  "name": "Codariq"
                },
                "areaServed": ["DE", "AT", "CH"],
                "serviceType": "Business Process Analysis",
                "category": "Artificial Intelligence Consulting"
              },
              "price": "999",
              "priceCurrency": "EUR",
              "priceSpecification": [
                {
                  "@type": "PriceSpecification",
                  "name": "Regulärer Preis",
                  "price": "999",
                  "priceCurrency": "EUR",
                  "valueAddedTaxIncluded": true
                },
                {
                  "@type": "PriceSpecification",
                  "name": "Neukunden-Rabatt (25%)",
                  "price": "749",
                  "priceCurrency": "EUR",
                  "valueAddedTaxIncluded": true,
                  "eligibleQuantity": {
                    "@type": "QuantitativeValue",
                    "value": 1
                  },
                  "eligibleCustomerType": "New Customer"
                }
              ],
              "availability": "https://schema.org/InStock",
              "deliveryLeadTime": "P1W/P2W"
            },
            {
              "@type": "Offer",
              "@id": "https://codariq.de/#automation-pilot",
              "itemOffered": {
                "@type": "Service",
                "name": "Automation Pilot",
                "description": "Entwicklung und Implementierung einer individuellen Automatisierungslösung",
                "provider": {
                  "@type": "Organization",
                  "name": "Codariq"
                },
                "areaServed": ["DE", "AT", "CH"],
                "serviceType": "Custom AI Development",
                "category": "Artificial Intelligence Implementation"
              },
              "priceRange": "2500-9500 EUR",
              "priceCurrency": "EUR",
              "priceSpecification": [
                {
                  "@type": "PriceSpecification",
                  "name": "Regulärer Preis",
                  "minPrice": "2500",
                  "maxPrice": "9500",
                  "priceCurrency": "EUR",
                  "valueAddedTaxIncluded": true
                },
                {
                  "@type": "PriceSpecification",
                  "name": "Neukunden-Rabatt (25%)",
                  "minPrice": "1875",
                  "maxPrice": "7125",
                  "priceCurrency": "EUR",
                  "valueAddedTaxIncluded": true,
                  "eligibleQuantity": {
                    "@type": "QuantitativeValue",
                    "value": 1
                  },
                  "eligibleCustomerType": "New Customer"
                }
              ],
              "availability": "https://schema.org/InStock",
              "deliveryLeadTime": "P4W/P12W"
            },
            {
              "@type": "Offer",
              "@id": "https://codariq.de/#team-training",
              "itemOffered": {
                "@type": "Service",
                "name": "Team Training & AI Awareness",
                "description": "Kombination aus Analyse und praxisnaher Schulung",
                "provider": {
                  "@type": "Organization",
                  "name": "Codariq"
                },
                "areaServed": ["DE", "AT", "CH"],
                "serviceType": "Professional Training",
                "category": "Artificial Intelligence Training"
              },
              "price": "1999",
              "priceCurrency": "EUR",
              "priceSpecification": [
                {
                  "@type": "PriceSpecification",
                  "name": "Regulärer Preis",
                  "price": "1999",
                  "priceCurrency": "EUR",
                  "valueAddedTaxIncluded": true
                },
                {
                  "@type": "PriceSpecification",
                  "name": "Neukunden-Rabatt (25%)",
                  "price": "1499",
                  "priceCurrency": "EUR",
                  "valueAddedTaxIncluded": true,
                  "eligibleQuantity": {
                    "@type": "QuantitativeValue",
                    "value": 1
                  },
                  "eligibleCustomerType": "New Customer"
                }
              ],
              "availability": "https://schema.org/InStock",
              "deliveryLeadTime": "P1W/P3W"
            },
            {
              "@type": "Offer",
              "@id": "https://codariq.de/#strategische-beratung",
              "itemOffered": {
                "@type": "Service",
                "name": "Strategische Beratung",
                "description": "Kontinuierliche strategische Beratung und Optimierung der KI-Automatisierungsstrategie",
                "provider": {
                  "@type": "Organization",
                  "name": "Codariq"
                },
                "areaServed": ["DE", "AT", "CH"],
                "serviceType": "Strategic AI Consulting",
                "category": "Artificial Intelligence Consulting"
              },
              "priceRange": "499-1500 EUR",
              "priceCurrency": "EUR",
              "availability": "https://schema.org/InStock",
              "billingIncrement": "P1M",
              "recurringCharge": true
            }
          ]
        }
      }
    </script>

    <!-- Special Announcement Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "SpecialAnnouncement",
        "name": "Kostenlose KI-Automatisierung Strategieberatung",
        "text": "Erhalten Sie eine kostenlose 45-minütige Strategieberatung zur Identifikation Ihrer besten KI-Automatisierungsmöglichkeiten. Unverbindlich und ohne Risiko.",
        "category": "https://www.wikidata.org/wiki/Q186386",
        "datePosted": "2024-12-28",
        "expires": "2025-12-31",
        "spatialCoverage": {
          "@type": "Country",
          "name": "Deutschland"
        },
        "announcementLocation": {
          "@type": "VirtualLocation",
          "url": "https://codariq.de"
        },
        "publisher": {
          "@type": "Organization",
          "name": "Codariq",
          "url": "https://codariq.de"
        }
      }
    </script>

    <!-- Local Business Schema -->
    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "ProfessionalService",
        "name": "Codariq - KI-Automatisierung",
        "image": "https://codariq.de/images/hero/hero2.webp",
        "@id": "https://codariq.de",
        "url": "https://codariq.de",
        "telephone": "+49-176-31378294",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Berlin",
          "addressRegion": "Berlin",
          "postalCode": "10713",
          "addressCountry": "DE"
        },
        "openingHoursSpecification": {
          "@type": "OpeningHoursSpecification",
          "dayOfWeek": ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
          "opens": "09:00",
          "closes": "18:00"
        },
        "priceRange": "€€€",
        "serviceType": "Business Automation and AI Services"
      }
    </script>
  </head>

  <body
    class="bg-white text-gray-900 antialiased overscroll-behavior-y-contain"
  >
    <!-- Service Worker Cleanup - Clear existing SW for development -->
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker
          .getRegistrations()
          .then(function (registrations) {
            for (let registration of registrations) {
              registration.unregister();
              console.log('ServiceWorker unregistered');
            }
          });
      }
    </script>
    <!-- Skip Links for accessibility -->
    <a
      href="#main-content"
      class="sr-only focus:not-sr-only focus:absolute focus:top-0 focus:left-0 bg-blue-600 text-white p-3 z-50 focus:z-50 rounded"
    >
      Zum Hauptinhalt springen
    </a>

    <div class="min-h-screen flex flex-col">
      <header
        class="fixed top-0 left-0 right-0 z-50 bg-white/30 backdrop-blur-lg border-b border-white/30"
        style="position: fixed !important; transform: translateY(0) !important;"
      >
        <!-- Header content will be added here -->
        <nav
          class="max-w-8xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 xl:px-16 h-14 sm:h-16 grid grid-cols-3 items-center"
          id="main-nav"
        >
          <!-- Left: Logo -->
          <div class="flex items-center justify-start">
            <a href="/" class="hover:opacity-90 transition-all duration-300">
              <img
                src="/Logo1.svg"
                alt="Codariq"
                class="h-8 sm:h-10 w-auto transition-all duration-300"
                id="nav-logo"
              />
            </a>
          </div>

          <!-- Center: Desktop Navigation -->
          <div
            class="hidden sm:flex items-center justify-center space-x-4 md:space-x-8"
            id="nav-links"
          >
            <a
              href="/#benefits"
              class="nav-link text-gray-800 hover:text-gray-600 transition-colors font-medium text-sm md:text-base"
              >Lösungen</a
            >
            <a
              href="/#benefits"
              class="nav-link text-gray-800 hover:text-gray-600 transition-colors font-medium text-sm md:text-base"
              >Preise</a
            >
            <a
              href="/#testimonials"
              class="nav-link text-gray-800 hover:text-gray-600 transition-colors font-medium text-sm md:text-base"
              >Referenzen</a
            >
            <a
              href="/#process"
              class="nav-link text-gray-800 hover:text-gray-600 transition-colors font-medium text-sm md:text-base"
              >Vorgehen</a
            >
          </div>

          <!-- Right: CTA and Mobile Menu -->
          <div class="flex items-center justify-end space-x-4">
            <!-- Mobile Menu Button -->
            <button
              id="mobile-menu-button"
              class="sm:hidden p-2 text-gray-800 hover:text-gray-600 focus:outline-none focus:ring-2 focus:ring-orange-500 rounded-lg"
              aria-label="Menu öffnen"
              aria-expanded="false"
            >
              <svg
                class="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M4 6h16M4 12h16M4 18h16"></path>
              </svg>
            </button>

            <a
              href="/#final-cta"
              class="bg-gradient-to-br from-orange-500 to-orange-700 text-white px-3 sm:px-4 md:px-6 py-2 rounded-full hover:from-orange-600 hover:to-orange-800 transition-all duration-200 font-bold text-xs sm:text-sm md:text-base shadow-lg cta-button"
              aria-label="Strategiegespräch vereinbaren"
            >
              <span class="hidden sm:inline">Termin buchen</span>
              <span class="sm:hidden">Kontakt</span>
            </a>
          </div>
        </nav>

        <!-- Mobile Menu -->
        <div
          id="mobile-menu"
          class="sm:hidden hidden bg-white/95 backdrop-blur-lg border-b border-white/30"
        >
          <div class="px-4 py-3 space-y-3">
            <a
              href="/#benefits"
              class="block text-gray-800 hover:text-gray-600 transition-colors font-medium py-2"
              >Lösungen</a
            >
            <a
              href="/#benefits"
              class="block text-gray-800 hover:text-gray-600 transition-colors font-medium py-2"
              >Preise</a
            >
            <a
              href="/#testimonials"
              class="block text-gray-800 hover:text-gray-600 transition-colors font-medium py-2"
              >Referenzen</a
            >
            <a
              href="/#process"
              class="block text-gray-800 hover:text-gray-600 transition-colors font-medium py-2"
              >Vorgehen</a
            >
          </div>
        </div>
      </header>

      <main class="flex-1" id="main-content" role="main">
        <slot />
      </main>

      <footer class="bg-gray-50 border-t border-gray-200" role="contentinfo">
        <div
          class="max-w-8xl mx-auto px-3 sm:px-4 md:px-6 lg:px-8 xl:px-16 py-8 sm:py-10 md:py-12"
        >
          <div
            class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 sm:gap-8"
          >
            <div class="col-span-2">
              <div class="flex items-end gap-8 mb-4">
                <img
                  src="/Logo1.svg"
                  alt="Codariq"
                  class="h-25 w-auto"
                  loading="lazy"
                  decoding="async"
                />
                <div class="flex items-end h-25">
                  <div class="h-25 w-px bg-gray-300 mx-4"></div>
                  <div class="flex flex-col justify-center h-full">
                    <div class="flex space-x-3">
                      <!-- Trust badges next to logo -->
                      <img
                        src="/images/badges/climate-friendly.webp"
                        alt="Klimafreundlich"
                        class="h-20"
                        loading="lazy"
                        decoding="async"
                      />
                      <img
                        src="/images/badges/gdpr-ready.webp"
                        alt="DSGVO konform"
                        class="h-20"
                        loading="lazy"
                        decoding="async"
                      />
                      <img
                        src="/images/badges/remote-only.webp"
                        alt="Remote verfügbar"
                        class="h-20"
                        loading="lazy"
                        decoding="async"
                      />
                    </div>
                  </div>
                </div>
              </div>
              <p class="text-gray-600 mb-4">
                Wir digitalisieren Ihre Geschäftsprozesse mit maßgeschneiderten
                KI-Lösungen.
              </p>
              <div class="flex flex-col">
                <span class="text-gray-500 text-sm mb-3"
                  >Powered by industry leaders:</span
                >
                <div class="flex items-center space-x-6">
                  <a
                    href="https://www.coursera.org/account/accomplishments/specialization/certificate/02X85MNGYZGE"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="hover:opacity-90 transition-opacity"
                    aria-label="View Google certification on Coursera"
                  >
                    <img
                      src="/images/logos/google.svg"
                      alt="Google"
                      class="h-16 w-auto opacity-60 hover:opacity-100 transition-opacity"
                      loading="lazy"
                      decoding="async"
                    />
                  </a>
                  <a
                    href="https://www.credly.com/badges/bc236bf7-2cb8-4435-bbea-660a4c37329e/public_url"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="hover:opacity-90 transition-opacity"
                    aria-label="View IBM certification on Credly"
                  >
                    <img
                      src="/images/logos/ibm.svg"
                      alt="IBM"
                      class="h-22 w-auto opacity-60 hover:opacity-100 transition-opacity"
                      loading="lazy"
                      decoding="async"
                    />
                  </a>
                  <a
                    href="https://learn.deeplearning.ai/accomplishments/4c4f4d61-8e90-4756-b0a3-1b32b7111c97?usp=sharing"
                    target="_blank"
                    rel="noopener noreferrer"
                    class="hover:opacity-90 transition-opacity"
                    aria-label="View DeepLearning.AI accomplishments"
                  >
                    <img
                      src="/images/logos/openai.svg"
                      alt="OpenAI"
                      class="h-16 w-auto opacity-60 hover:opacity-100 transition-opacity"
                      loading="lazy"
                      decoding="async"
                    />
                  </a>
                </div>
              </div>
            </div>

            <div>
              <h3 class="font-semibold text-gray-900 mb-4">Unternehmen</h3>
              <ul class="space-y-2 text-gray-600">
                <li>
                  <a href="/impressum" class="hover:text-primary-600"
                    >Impressum</a>
                </li>
                <li>
                  <a href="/datenschutz" class="hover:text-primary-600"
                    >Datenschutzerklärung</a>
                </li>
                <li>
                  <a href="/cookie-richtlinien" class="hover:text-primary-600"
                    >Cookie-Richtlinien</a>
                </li>
                <li><a href="/faq" class="hover:text-primary-600">FAQ</a></li>
                <li><a href="/agb" class="hover:text-primary-600">AGB</a></li>
              </ul>
            </div>

            <div>
              <h3 class="font-semibold text-gray-900 mb-4">Kontakt</h3>
              <ul class="space-y-2 text-gray-600">
                <li>kontakt@codariq.de</li>
                <li>Made with love in Berlin ❤️</li>
              </ul>
            </div>

            <div
              class="border-t border-gray-200 mt-8 pt-8 text-center text-gray-500"
            >
              <p>&copy; 2025 Codariq. Alle Rechte vorbehalten.</p>
            </div>
          </div>
        </div>
      </footer>

      <!-- Cookie Consent -->
      <CookieConsent />

      <!-- Mobile Menu and Smooth Scrolling JavaScript -->
      <script>
        document.addEventListener('DOMContentLoaded', function () {
          // Mobile Menu Logic
          const mobileMenuButton =
            document.getElementById('mobile-menu-button');
          const mobileMenu = document.getElementById('mobile-menu');

          if (mobileMenuButton && mobileMenu) {
            mobileMenuButton.addEventListener('click', function () {
              const isExpanded =
                mobileMenuButton.getAttribute('aria-expanded') === 'true';

              if (isExpanded) {
                mobileMenu.classList.add('hidden');
                mobileMenuButton.setAttribute('aria-expanded', 'false');
                mobileMenuButton.innerHTML =
                  '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>';
              } else {
                mobileMenu.classList.remove('hidden');
                mobileMenuButton.setAttribute('aria-expanded', 'true');
                mobileMenuButton.innerHTML =
                  '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>';
              }
            });

            // Close mobile menu when clicking on a link
            const mobileLinks = mobileMenu.querySelectorAll('a');
            mobileLinks.forEach(link => {
              link.addEventListener('click', function () {
                mobileMenu.classList.add('hidden');
                mobileMenuButton.setAttribute('aria-expanded', 'false');
                mobileMenuButton.innerHTML =
                  '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>';
              });
            });
          }

          // Enhanced Smooth Scrolling for Internal Links
          const allLinks = document.querySelectorAll(
            'a[href^="#"], a[href^="/#"]'
          );
          allLinks.forEach(link => {
            link.addEventListener(
              'click',
              function (this: HTMLAnchorElement, e) {
                const href = this.getAttribute('href');
                if (!href) return;

                const targetId = href.startsWith('/#')
                  ? href.substring(2)
                  : href.substring(1);
                const targetElement = document.getElementById(targetId);

                if (targetElement) {
                  e.preventDefault();

                  // Close mobile menu if open
                  if (mobileMenu && !mobileMenu.classList.contains('hidden')) {
                    mobileMenu.classList.add('hidden');
                    if (mobileMenuButton) {
                      mobileMenuButton.setAttribute('aria-expanded', 'false');
                      mobileMenuButton.innerHTML =
                        '<svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>';
                    }
                  }

                  // Smooth scroll with offset for fixed header
                  const headerOffset = 80; // Account for fixed header
                  const elementPosition =
                    targetElement.getBoundingClientRect().top;
                  const offsetPosition =
                    elementPosition + window.pageYOffset - headerOffset;

                  window.scrollTo({
                    top: offsetPosition,
                    behavior: 'smooth',
                  });

                  // Update URL without causing a jump
                  window.history.pushState({}, '', href);
                }
              }
            );
          });
          
          // Intersection Observer for scroll animations
          if ('IntersectionObserver' in window) {
            const observerOptions = {
              threshold: 0.1,
              rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver((entries) => {
              entries.forEach(entry => {
                if (entry.isIntersecting) {
                  entry.target.classList.add('is-visible');
                  observer.unobserve(entry.target); // Only animate once
                }
              });
            }, observerOptions);
            
            // Observe all elements with animate-on-scroll class
            document.querySelectorAll('.animate-on-scroll').forEach(el => {
              observer.observe(el);
            });
          } else {
            // Fallback for browsers without IntersectionObserver
            document.querySelectorAll('.animate-on-scroll').forEach(el => {
              el.classList.add('is-visible');
            });
          }
        });
      </script>
    </div>
  </body>
</html>
